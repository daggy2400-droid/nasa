<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Withdrawal Request</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: Arial, sans-serif;background: conic-gradient(from 0deg at 50% 50%,purple,rgb(39, 175, 16),rgb(4, 182, 182),rgb(183, 233, 32),rgb(210, 159, 221),rgb(18, 208, 84),rgb(193, 18, 193), rgb(243, 210, 22), rgb(23, 108, 17),rgb(218, 47, 127),rgb(231, 223, 214), purple);min-height: 100vh; display: flex; flex-direction: column; align-items: center; }
        .header { color: white; padding: 1.5rem; text-align: center; width: 100%; background: conic-gradient(from 0deg at 50% 50%,purple,rgb(39, 175, 16),rgb(4, 182, 182),rgb(183, 233, 32),rgb(210, 159, 221),rgb(18, 208, 84),rgb(193, 18, 193), rgb(243, 210, 22), rgb(23, 108, 17),rgb(218, 47, 127),rgb(231, 223, 214), purple); }
        .container { padding: 2rem; display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 700px; }
        .form-container { background: linear-gradient(45deg,#010c3f,#40382b,#520262,#025f0b);padding: 20px; margin-top: 20px; color: #efedf5; border-radius: 10px; width: 100%; }
        .balance-display { text-align: center; margin-bottom: 20px; padding: 15px;background: linear-gradient(45deg,#010c3f,#916b2e,#033c2e,#06e71d); border-radius: 8px; font-size: 1.2em; font-weight: bold; }
        .form-group { margin-bottom: 1.2rem; width: 100%; }
        .form-group label { display: block; font-weight: bold; margin-bottom: 0.5rem; color: white; }
        .form-group input, .form-group select { width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 8px;background: linear-gradient(45deg,#050607,#0f0901,#a803a2,#03640d);color: white; }
        .withdraw-button { width: 100%; padding: 0.8rem; background: linear-gradient(45deg,#010c3f,#916b2e,#033c2e,#06e71d);color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .message { font-size: 0.8rem; margin-bottom: 1rem; text-align: center; }
        .error { color: #e74c3c; }
        .success { color: #8edca0; }
        .warning { color: #f39c12; }
        .back-link { display: block; text-align: center; color: #d4b344; text-decoration: none; margin-top: 1rem; }
        .lang-toggle { position: fixed; top: 20px; right: 20px; background-color: #ff6b35; color: white; border: none; padding: 8px 12px; border-radius: 20px; cursor: pointer; font-size: 12px; z-index: 1000; }
        .history-section { margin-top: 30px; padding: 20px;background: linear-gradient(45deg,#010c3f,#916b2e,#033c2e,#06e71d);border-radius: 8px; }
        .history-item { padding: 10px; margin: 5px 0; background: linear-gradient(45deg,#1e3f01,#1a1001,#e1be11,#091469); border-radius: 5px; border-left: 4px solid #28a745; }
        .history-item.pending { border-left-color: #ffc107; }
        .history-item.rejected { border-left-color: #dc3545; }
        .status-badge { padding: 3px 8px; border-radius: 12px; font-size: 0.8em; font-weight: bold; }
        .status-pending { background-color: #ffc107; color: #000; }
        .status-approved { background-color: #28a745; color: #fff; }
        .status-rejected { background-color: #dc3545; color: #fff; }
    </style>
</head>
<body>
    <button id="langToggle" class="lang-toggle" onclick="switchLanguage()">EN</button>
    <header class="header">
        <h1>
            <span id="withdrawalTitle-en">Withdrawal Request</span>
            <span id="withdrawalTitle-am" style="display:none">የመውጣት ጥያቄ</span>
            <span id="withdrawalTitle-zh" style="display:none">提款申请</span>
            <span id="withdrawalTitle-es" style="display:none">Solicitud de Retiro</span>
        </h1>
        <p>
            <span id="withdrawalSubtitle-en">Request to withdraw your earnings</span>
            <span id="withdrawalSubtitle-am" style="display:none">የእርስዎን ገቢ ለማውጣት ጥያቄ</span>
            <span id="withdrawalSubtitle-zh" style="display:none">申请提取您的收入</span>
            <span id="withdrawalSubtitle-es" style="display:none">Solicitar retirar tus ganancias</span>
        </p>
    </header>
    <div class="container">
        <div class="form-container">
            <div class="balance-display">
                <span id="balanceLabel-en">Available Balance:</span>
                <span id="balanceLabel-am" style="display:none">ያለ ሂሳብ:</span>
                <span id="balanceLabel-zh" style="display:none">可用余额:</span>
                <span id="balanceLabel-es" style="display:none">Saldo Disponible:</span>
                {user.walletBalance} ETB
            </div>
            
            {#if error}
                <div class="message error">{error}</div>
            {/if}
            {#if success}
                <div class="message success">{success}</div>
            {/if}
            {#if warning}
                <div class="message warning">{warning}</div>
            {/if}
            
            <form method="post" action="/withdrawal">
                <div class="form-group">
                    <label for="amount">
                        <span id="amountLabel-en">Withdrawal Amount (ETB)</span>
                        <span id="amountLabel-am" style="display:none">የመውጣት መጠን (ETB)</span>
                        <span id="amountLabel-zh" style="display:none">提款金额 (ETB)</span>
                        <span id="amountLabel-es" style="display:none">Monto de Retiro (ETB)</span>
                    </label>
                    <input type="number" id="amount" name="amount" min="100" step="0.01" placeholder="Minimum 100 ETB" required>
                </div>
                <div class="form-group">
                    <label for="bankAccount">
                        <span id="accountLabel-en">Bank Account Number</span>
                        <span id="accountLabel-am" style="display:none">የባንክ መለያ ቁጥር</span>
                        <span id="accountLabel-zh" style="display:none">银行账号</span>
                        <span id="accountLabel-es" style="display:none">Número de Cuenta Bancaria</span>
                    </label>
                    <input type="text" id="bankAccount" name="bankAccount" placeholder="Enter your bank account number" required>
                </div>
                <button type="submit" class="withdraw-button">
                    <span id="submitBtn-en">Submit Withdrawal Request</span>
                    <span id="submitBtn-am" style="display:none">የመውጣት ጥያቄ አስገባ</span>
                    <span id="submitBtn-zh" style="display:none">提交提款申请</span>
                    <span id="submitBtn-es" style="display:none">Enviar Solicitud de Retiro</span>
                </button>
            </form>
            
            <!-- Recent Withdrawal History -->
            <div class="history-section">
                <h3>
                    <span id="historyTitle-en">Recent Withdrawal Requests (Last 10)</span>
                    <span id="historyTitle-am" style="display:none">የቅርብ ጊዜ የመውጣት ጥያቄዎች (የመጨረሻዎቹ 10)</span>
                    <span id="historyTitle-zh" style="display:none">最近的提款申请 (最后10个)</span>
                    <span id="historyTitle-es" style="display:none">Solicitudes de Retiro Recientes (Últimas 10)</span>
                </h3>
                {#if withdrawalHistory && !withdrawalHistory.isEmpty()}
                    {#for withdrawal in withdrawalHistory}
                    <div class="history-item {withdrawal.status.toLowerCase()}">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>{withdrawal.amount} ETB</strong><br>
                                <small>{withdrawal.createdAt}</small>
                            </div>
                            <span class="status-badge status-{withdrawal.status.toLowerCase()}">{withdrawal.status}</span>
                        </div>
                        {#if withdrawal.adminNotes}
                            <div style="margin-top: 5px; font-size: 0.9em; color: #ccc;">
                                <span id="noteLabel-en">Note:</span>
                                <span id="noteLabel-am" style="display:none">ማስታወሻ:</span>
                                <span id="noteLabel-zh" style="display:none">备注:</span>
                                <span id="noteLabel-es" style="display:none">Nota:</span>
                                {withdrawal.adminNotes}
                            </div>
                        {/if}
                    </div>
                    {/for}
                {#else}
                    <div class="history-item">
                        <p>
                            <span id="noHistory-en">No withdrawal requests found</span>
                            <span id="noHistory-am" style="display:none">ምንም የመውጣት ጥያቄዎች አልተገኙም</span>
                            <span id="noHistory-zh" style="display:none">未找到提款申请</span>
                            <span id="noHistory-es" style="display:none">No se encontraron solicitudes de retiro</span>
                        </p>
                    </div>
                {/if}
            </div>
            
            <a class="back-link" href="/my">
                <span id="backBtn-en">Back to Dashboard</span>
                <span id="backBtn-am" style="display:none">ወደ ዳሽቦርድ ተመለስ</span>
                <span id="backBtn-zh" style="display:none">返回仪表板</span>
                <span id="backBtn-es" style="display:none">Volver al Panel</span>
            </a>
        </div>
    </div>

    <script src="/js/lang.js"></script>
</body>
</html>